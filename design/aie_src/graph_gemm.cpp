#include "graph_gemm.h"
#include "graph_utils.h"


template <template<int, int, int> class GEMM, int M, int K, int N>
class GemmReluGraphTest : public adf::graph {

  private:
    GemmReluGraph<GEMM, M, K, N> g;

  public:
    adf::input_plio plin[1];
    adf::output_plio plout[1];

    GemmReluGraphTest(
      const std::string& id,
      std::vector<float> weights,
      std::vector<float> bias,
      const std::string& INP_TXT,
      const std::string& OUT_TXT = "gemm_out.txt"
    ): g(weights, bias) { 
      plin[0] = adf::input_plio::create("plin0_gemm"+id+"_input", PLIO64_ARG(INP_TXT));
      plout[0] = adf::output_plio::create("plout0_gemm"+id+"_output", PLIO64_ARG(OUT_TXT));
      adf::connect<adf::window<M*K*4>> (plin[0].out[0], g.pin[0]);
      adf::connect<adf::window<M*N*4>> (g.pout[0], plout[0].in[0]);
    }

};


// instance to be compiled and used in host within xclbin
// mknk has no padding, mkkn pads N in 128-bit chunks for vector kernel
std::vector<float> weights_mknk {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839};
std::vector<float> weights_mknk_rand {0.5666014542065752, 0.2653894909394454, 0.5232480534666997, 0.09394051075844168, 0.5759464955561793, 0.9292961975762141, 0.31856895245132366, 0.6674103799636817, 0.13179786240439217, 0.7163272041185655, 0.2894060929472011, 0.18319136200711683, 0.5865129348100832, 0.020107546187493552, 0.8289400292173631, 0.004695476192547066, 0.6778165367962301, 0.27000797319216485, 0.7351940221225949, 0.9621885451174382, 0.24875314351995803, 0.5761573344178369, 0.592041931271839, 0.5722519057908734, 0.2230816326406183, 0.952749011516985, 0.44712537861762736, 0.8464086724711278, 0.6994792753175043, 0.29743695085513366, 0.8137978197024772, 0.39650574084698464, 0.8811031971111616, 0.5812728726358587, 0.8817353618548528, 0.6925315900777659, 0.7252542798196405, 0.5013243819267023, 0.9560836347232239, 0.6439901992296374, 0.4238550485581797, 0.6063932141279244, 0.019193198309333526, 0.30157481667454933, 0.660173537492685, 0.29007760721044407, 0.6180154289988415, 0.42876870094576613, 0.13547406422245023, 0.29828232595603077, 0.5699649107012649, 0.5908727612481732, 0.5743252488495788, 0.6532008198571336, 0.6521032700016889, 0.43141843543397396, 0.896546595851063, 0.36756187004789653, 0.4358649252656268, 0.8919233550156721, 0.8061939890460857, 0.7038885835403663, 0.10022688731230112, 0.9194826137446735, 0.7142412995491114, 0.9988470065678665, 0.14944830465799375, 0.8681260573682142, 0.16249293467637482, 0.6155595642838442, 0.12381998284944151, 0.8480082293222344, 0.8073189587250107, 0.5691007386145933, 0.40718329722599966, 0.06916699545513805, 0.6974287731445636, 0.45354268267806885, 0.7220555994703479, 0.8663823259286292, 0.9755215050028858, 0.855803342392611, 0.011714084185001972, 0.3599780644783639, 0.729990562424058, 0.17162967726144052, 0.5210366062041293, 0.05433798833925363, 0.19999652489640007, 0.01852179446061397, 0.7936977033574206, 0.22392468806038013, 0.3453516806969027, 0.9280812934655909, 0.7044144019235328, 0.03183892953130785, 0.16469415649791275, 0.6214784014997635, 0.5772285886041676, 0.23789282137450862, 0.9342139979247938, 0.613965955965896, 0.5356328030249583, 0.589909976354571, 0.7301220295167696, 0.31194499547960186, 0.3982210622160919, 0.20984374897512215, 0.18619300588033616, 0.9443723899839336, 0.7395507950492876, 0.4904588086175671, 0.22741462797332324, 0.25435648177039294, 0.05802916032387562, 0.4344166255581208, 0.3117958819941026, 0.6963434888154595, 0.3777518392924809, 0.1796036775596348, 0.02467872839133123, 0.06724963146324858, 0.6793927734985673, 0.4536968445560453, 0.5365792111087222, 0.8966712930403421, 0.9903389473967044, 0.21689698439847394, 0.6630782031001008, 0.26332237673715064, 0.02065099946572868, 0.7583786538361414, 0.32001715082246784, 0.38346389417189797, 0.5883171135536057, 0.8310484552361904, 0.6289818435911487, 0.8726506554473953, 0.27354203481563577, 0.7980468339125637, 0.1856359443059522, 0.9527916569719446, 0.6874882763878153, 0.21550767711355845, 0.9473705904889242, 0.7308558067701578, 0.25394164259502583, 0.21331197736748198, 0.5182007139306632, 0.025662718054531575, 0.2074700754411094, 0.42468546875150626, 0.37416998033422555, 0.4635754243648107, 0.2776287062947319, 0.5867843464581688, 0.8638556059232314, 0.11753185596203308, 0.5173791071541142, 0.1320681063451533, 0.7168596811925937, 0.39605970280729375, 0.565421311858509, 0.18327983621407862, 0.14484775934337724, 0.48805628064895457, 0.3556127378499556, 0.940431945252813, 0.7653252538069653, 0.7486636198505473, 0.9037197397459334, 0.08342243544201855, 0.5521924699224066, 0.5844760689557689, 0.961936378547229, 0.29214752679254885, 0.24082877991544682, 0.10029394226549782, 0.016429629591474204, 0.9295293167921905, 0.66991654659091, 0.7851529120231378, 0.2817301057539491, 0.5864101661863267, 0.06395526612098112, 0.4856275959346229, 0.9774951397444468, 0.8765052453165908, 0.33815895183684563, 0.9615701545414985, 0.2317016264712045, 0.9493188224156814, 0.9413777047064986, 0.7992025873523917, 0.6304479368667911, 0.874287966624947, 0.2930202845077967, 0.8489435553129182, 0.6178766919175238, 0.01323685775889949, 0.34723351793221957, 0.14814086094816503, 0.9818293898182532, 0.47837030703998806, 0.4973913654986627, 0.6394725163987236, 0.3685846061296175, 0.13690027168559893, 0.8221177331942455, 0.18984791190275796, 0.511318982546456, 0.22431702897473926, 0.09784448449403405, 0.8621915174216833, 0.9729194890231303, 0.9608346580630002, 0.906555499221179, 0.7740473326986388, 0.3331451520286419, 0.08110138998799676, 0.40724117141380733, 0.23223414217094274, 0.13248763475798297, 0.05342718178682526, 0.7255943642105788, 0.011427458625031028, 0.7705807485027762, 0.14694664540037505, 0.07952208258675575, 0.08960303423860538, 0.6720478073539145, 0.24536720985284477, 0.42053946668009845, 0.5573687913239169, 0.8605511738287938, 0.7270442627113283, 0.27032790523871464, 0.1314827992911276, 0.05537432042119794, 0.3015986344809425, 0.26211814923967824, 0.45614056680047965, 0.6832813355476804, 0.6956254456388572, 0.28351884658216664, 0.3799269559001205, 0.18115096173690304, 0.7885455123065187, 0.0568480764332403, 0.6969972417249873, 0.7786953959411034, 0.7774075618487531, 0.25942256434535493, 0.37381313793256143, 0.587599635196389, 0.272821902424467, 0.3708527992178887, 0.19705428018563964, 0.4598558837560074, 0.044612301254114084, 0.799795884570618, 0.07695644698663273, 0.518835148831526, 0.3068100995451961, 0.5775429488313755, 0.9594333408334251, 0.6455702444560039, 0.03536243575549092, 0.43040243950806123, 0.5100168523182502, 0.536177494703452, 0.6813925106038379, 0.2775960977317661, 0.1288605654663202, 0.39267567654709434, 0.9564057227959488, 0.18713089175084474, 0.903983954928237, 0.5438059500773263, 0.4569114216457658, 0.8820414102298896, 0.45860396176858587, 0.7241676366115433, 0.399025321703102, 0.9040443929009577, 0.6900250201912274, 0.6996220542505167, 0.3277204015571189, 0.7567786427368892, 0.6360610554471413, 0.24002027337970955, 0.16053882248525642, 0.7963914745173317, 0.9591666030352225, 0.45813882726004285, 0.5909841653236849, 0.8577226441935546, 0.45722345335385706, 0.9518744768327362, 0.5757511620448724, 0.820767120701315, 0.9088437184127384, 0.8155238187685688, 0.15941446344895593, 0.6288984390617004, 0.3984342586196771, 0.0627129520233457, 0.42403225188984195, 0.2586840668894077, 0.8490383084285108, 0.03330462654669619, 0.9589827218634736, 0.3553688484719296, 0.3567068904025429, 0.01632850268370789, 0.18523232523618394, 0.4012595008036087, 0.9292914173027139, 0.09961493022127133, 0.9453015334790795, 0.8694885305466322, 0.4541623969075518, 0.32670088176826007, 0.23274412927905685, 0.6144647064768743, 0.03307459147550562, 0.015606064446828216, 0.42879572249823783, 0.0680740739747202, 0.2519409882460929, 0.22116091534608384, 0.2531911937228519, 0.13105523121525775, 0.01203622289765427, 0.11548429713874808, 0.6184802595127479, 0.9742562128180503, 0.9903450015608939, 0.4090540953730616, 0.16295442604660537, 0.6387617573665293, 0.49030534654873714, 0.9894097772844315, 0.0653042071517802, 0.7832344383138131, 0.2883984973314939, 0.241418620076574, 0.662504571532676, 0.24606318499096447, 0.6658591175591877, 0.5173085172022888, 0.4240889884358493, 0.554687808661419, 0.28705151991962974, 0.7065747062729789, 0.414856869333564, 0.36054556048589226, 0.8286569145557378, 0.9249669119531921, 0.046007310887296926, 0.2326269928297655, 0.34851936949256324, 0.8149664793702474, 0.9854914276432976, 0.9689717046703518, 0.9049483455499269, 0.2965562650640299, 0.9920112434144741, 0.2494200410564512, 0.1059061548822322, 0.9509526110553941, 0.2334202554680963, 0.6897682650777505, 0.05835635898058866, 0.7307090991274762, 0.8817202123338397, 0.2724368954659625, 0.37905689607742854, 0.3742961833209161, 0.7487882575401331, 0.23780724253903884, 0.171853099047643, 0.4492916486877381, 0.3044684073773195, 0.8391891222586524, 0.23774182601563876, 0.5023894574892614, 0.9425835996979304, 0.6339976977446607, 0.8672894054624648, 0.9402096893547673, 0.7507648618863519, 0.6995750602247514, 0.9679655666042271, 0.9944007896476794, 0.45182168266975964, 0.07086977818420837, 0.29279403144051885, 0.15235470568773046, 0.4174863747960118, 0.13128932847325603, 0.604117804020882, 0.3828080591578541, 0.89538588428821, 0.9677946717985019, 0.5468849016694222, 0.2748235698675966, 0.5922304187618368, 0.8967611582244098, 0.4067333458357483, 0.5520782766919708, 0.2716527676061459, 0.455444149450027, 0.40171353537959864, 0.24841346508297102, 0.5058663838253084, 0.3103808259798114, 0.37303486388074747, 0.5249704422542643, 0.7505950229289875, 0.3335074657912753, 0.9241587666207636, 0.8623185468359024, 0.04869029597552854, 0.25364252425682277, 0.4461355126592019, 0.10462788874247408, 0.3484759890334971, 0.7400975256176825, 0.6805144811428259, 0.6223844285660048, 0.7105284027223456, 0.20492368695970176, 0.3416981148647321, 0.6762424822774629, 0.8792347630313271, 0.5436780538280952, 0.2826996509455366, 0.03023525800598259, 0.7103368289742134, 0.007884103508440377, 0.3726790698209955, 0.5305372145627818, 0.922111461767193, 0.08949454503290011, 0.4059423219682837, 0.024313199710157773, 0.3426109843415903, 0.6222310588397949, 0.2790679482285984, 0.2097499496556351, 0.11570323332709365, 0.5771402440203418, 0.695270005904686, 0.6719571405958223, 0.9488610207205074, 0.0027032138935026984, 0.647196653894036, 0.6003922370976396, 0.5887396099702882, 0.9627703198402424, 0.016871673370039697, 0.6964824307014501, 0.8136786497018634, 0.5098071966215841, 0.33396486959680916, 0.7908401632274049, 0.09724292563242465, 0.44203563772992527, 0.5199523745708382, 0.6939564109345475, 0.09088573203240946, 0.22775950153786095, 0.41030156269012563, 0.6232946730201306, 0.8869607812174175, 0.6188261682413765, 0.13346147093493443, 0.9805801327872824, 0.8717857347554929, 0.502720761145324, 0.922347981796633, 0.5413807937571358, 0.9233060678891631, 0.8298973686033432, 0.9682864102942973, 0.9197828107781584, 0.03603381742856948, 0.17477200416093996, 0.38913467710118577, 0.9521426972954208, 0.3000289194759296, 0.16046764388760104, 0.8863046660865599, 0.4463944154832029, 0.9078755943543261, 0.16023046632014326, 0.6611175115080995, 0.4402637528294918, 0.0764867690302854, 0.6964631446525006, 0.2473987555391537, 0.039615522579517726, 0.05994429824957326, 0.06107853706678734, 0.9077329574850395, 0.739883917829101, 0.8980623572137351, 0.6725823112965214, 0.5289399290308832, 0.30444636434737826, 0.9979622513286734, 0.36218905893938935, 0.47064894921390954, 0.37824517492346177, 0.9795269293354586, 0.17465838539500578, 0.32798800090807967, 0.6803486660150015, 0.06320761833863064, 0.607249374011541, 0.4776465028764161, 0.2839999767621011, 0.238413280924058, 0.5145127432987567, 0.36792758053704133, 0.45651989126265535, 0.3374773817642399, 0.9704936935959776, 0.13343943174560402, 0.0968039531783742, 0.34339172879091606, 0.5910269008704913, 0.6591764718500283, 0.39725674716804205, 0.9992779939221711, 0.3518929961930426, 0.7214066679599525, 0.6375826945307929, 0.8130538632474607, 0.97622566345382, 0.8897936564455402, 0.7645619743577086, 0.6982484778182906, 0.3354981696758996, 0.14768557820670736, 0.06263600305980976, 0.24190170420148482, 0.4322814811812986, 0.5219962736299825, 0.7730835540548716, 0.958740923056593, 0.11732048038481102, 0.10700414019379156, 0.5896947230135507, 0.745398073947293, 0.8481503803469849, 0.9358320802167885, 0.983426242260642, 0.3998016922245259, 0.3803351835275731, 0.14780867669727238, 0.6849344386835594, 0.6567619584408371, 0.8620625958512073, 0.09725799478764063, 0.4977769078253418, 0.5810819296720631, 0.2415570400399184, 0.16902540612916128, 0.8595808364196215, 0.058534922235558784, 0.4706209039180729, 0.11583400130088528, 0.45705876133136736, 0.9799623263423093, 0.4237063534554728, 0.8571249175045673, 0.11731556418319389, 0.27125207676186414, 0.4037927406673345, 0.39981214000933074, 0.6713834786701531, 0.34471812737550767, 0.7137668684100164, 0.6391868992253925, 0.3991611452547731, 0.43176012765431926, 0.6145276998103207, 0.07004219014464463, 0.8224067383556903, 0.6534211611136369, 0.7263424644178352, 0.5369230010823904, 0.11047711099174473, 0.4050356132969499, 0.40537358284855607, 0.3210429900432169, 0.02995032490474936, 0.7372542425964773, 0.1097844580625007, 0.6063081330450851, 0.7032174964672158, 0.6347863229336947, 0.959142251977975, 0.10329815508513862, 0.8671671591051991, 0.029190234848913255, 0.534916854927084, 0.4042436179392588, 0.5241838603937582, 0.3650998770600098, 0.19056691494006806, 0.01912289744868978, 0.5181498137911743, 0.8427768626848423, 0.37321595574479416, 0.22286381801498023, 0.08053200347184408, 0.08531092311870336, 0.22139644629277222, 0.10001406092155518, 0.26503969836448205, 0.06614946211695472, 0.06560486720992564, 0.8562761796227819, 0.16212026070883323, 0.559682405823448, 0.7734555444490305, 0.4564095653390666, 0.15336887785934572, 0.19959614212011434, 0.43298420628118073, 0.5282340891785358, 0.3494402920485349, 0.7814796002346613, 0.7510216488563984, 0.9272118073731179, 0.02895254902696054, 0.8956912912102034, 0.39256878846215104, 0.8783724953799941, 0.6907847761565296, 0.9873487570739682, 0.7592824517166681, 0.3645446259967866, 0.5010631728347521, 0.37638915519435123, 0.3649118360212381, 0.26090449938105975, 0.4959702953734696, 0.6817399450693612, 0.2773402713052435, 0.52437981107722, 0.11738029417055718, 0.1598452868541913, 0.04680635471218875, 0.9707314427706328, 0.0038603515102610952, 0.1785799680576563, 0.6128667531169923, 0.0813695988533053, 0.8818965030968323, 0.7196201578422882, 0.9663899714378934, 0.5076355472407649, 0.3004036831584872, 0.5495005727952714, 0.9308187172979732, 0.5207614372418605, 0.26720703186231864, 0.8773987891741196, 0.3719187485124613, 0.0013833499989991394, 0.24768502249231594, 0.3182335091770624, 0.8587774682319022, 0.458503167066445, 0.44458728781130075, 0.3361022663998874, 0.8806781230470796, 0.9450267769403914, 0.9918903291546294, 0.37674126696098675, 0.9661474456271714, 0.7918795696309013, 0.6756891476442668, 0.24488947942009942, 0.2164572609442098, 0.16604782452124567, 0.9227566102253654, 0.2940766623831661, 0.45309424544887844, 0.4939578339872235, 0.7781715954502542, 0.8442349615530241, 0.1390727011486128, 0.4269043602110737, 0.8428548878354571, 0.8180333057558384, 0.1024137584524164, 0.156383348867963, 0.3041986915994078, 0.07535906908334034, 0.4246630028405929, 0.10761770514958191, 0.568217593669845, 0.24655693981115612, 0.5964330653496227, 0.11752564290363765, 0.9758838684185334, 0.9325612038573404, 0.3917969385646658, 0.24217859412608544, 0.2503982128535728, 0.48339353520239203, 0.03999280190071697, 0.639705106075127, 0.4083029083397448, 0.3774065725888873, 0.8093649714891984, 0.70903546018329, 0.954333815392692, 0.3519362404956907, 0.8975427646494055, 0.7699671862500889, 0.35742465159471304, 0.6216654364532578, 0.2885699576516956, 0.8743999170748423, 0.11242731721231125, 0.21243436129404103, 0.18303329207992114, 0.40302600240428865, 0.7452329600321291, 0.5269074490521803, 0.48767632353820756, 0.0005459648969956543, 0.4254017253550547, 0.06355377483615843, 0.20825325212148382, 0.9323939389604944, 0.2153982043432382, 0.8583376386342625, 0.8028933715613342, 0.15914623694224284, 0.6057119572702788, 0.11566187190501331, 0.7278881583695115, 0.6374622773722066, 0.8119385616910193, 0.47938454938918806, 0.9148630878333829, 0.04934894678843971, 0.29288856502701466, 0.715052597465167, 0.41810921174800086, 0.17295135427115638, 0.10721074542854603, 0.8173391114616214, 0.47314297846564424, 0.8822836719191074, 0.733289134316726, 0.4097262056307436, 0.37351101415568366, 0.5156383466512517, 0.8890599531897286, 0.7372785797141679, 0.00515296426902323, 0.6941578513691256, 0.9195074069058207, 0.7104557595044916, 0.1770057815674959, 0.4835181274274587, 0.1403160179234194, 0.3589952783396321, 0.9371170419405177, 0.9233053075587083, 0.2828368521760829, 0.33963104416619916, 0.6002128681312939, 0.96319729526038, 0.14780133406539042, 0.2569166436866691, 0.8735568272907714, 0.4918922317083445, 0.8989610922270317, 0.18551789752317627, 0.5326685874713607, 0.32626963264937237, 0.31654255989247604, 0.44687696394619913, 0.43307744910126844, 0.3573468796779544, 0.9149707703156186, 0.7317441854328928, 0.7275469913315297, 0.2899134495919554, 0.5777094243168404, 0.779179433301834, 0.7955903685432131, 0.34453046075431226, 0.7708727565686478, 0.735893896807733, 0.14150648562190027, 0.8659454685664772, 0.4413214701804108, 0.48641044888866547, 0.4483691788979973, 0.5678460014775075, 0.6211692473670547, 0.4981795657629434, 0.8667885432590956, 0.6277347561952844, 0.40142794930551995, 0.41669175690871096, 0.8108386151289514, 0.3481919427465201, 0.21145479578241355, 0.059383188005789234, 0.8760268479205742, 0.9185464511903499, 0.12012018216347597, 0.33447374149611486, 0.17537206951524387, 0.11589846882587973, 0.8998667430000302, 0.05687725914535546, 0.9804856634690068, 0.09645086069738418, 0.8634706491935857, 0.5665061069891627, 0.36791748781787337, 0.3423423766251579, 0.7573641432377087, 0.3145732950042872, 0.6573189166171418, 0.5173260835160801, 0.4849656451580705, 0.9011621706491616};

std::vector<float> weights_mkkn {0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 0, 0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 0, 0, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 0, 0, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 0, 0, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 0, 0, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 0, 0, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 0, 0, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 0, 0, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 0, 0, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 0, 0, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 0, 0, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 0, 0, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 0, 0, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 0, 0, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 0, 0, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 0, 0, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 0, 0, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 0, 0, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 0, 0, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 0, 0, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 0, 0, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 0, 0, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 0, 0, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 0, 0, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 0, 0, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 0, 0, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 0, 0, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 0, 0, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 0, 0, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 0, 0, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 0, 0, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 0, 0, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 0, 0, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 0, 0, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 0, 0, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 0, 0, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 0, 0, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 0, 0, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 0, 0, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 0, 0, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 0, 0, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 0, 0, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 0, 0, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 0, 0, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 0, 0, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 0, 0, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 0, 0, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 0, 0, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 0, 0, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 0, 0, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 0, 0, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 0, 0, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 0, 0, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 0, 0, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 0, 0, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 0, 0, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 0, 0, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 0, 0, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 0, 0, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 0, 0, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 0, 0, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 0, 0, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 0, 0, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 0, 0, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 0, 0, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 0, 0, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 0, 0, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 0, 0, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 0, 0, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 0, 0, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 0, 0, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 0, 0, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 0, 0, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 0, 0, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 0, 0, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 0, 0, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 0, 0, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 0, 0, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 0, 0, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 0, 0, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 0, 0, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 0, 0, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 0, 0, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 0, 0};
std::vector<float> weights_mkkn_rand {0.5666014542065752, 0.2653894909394454, 0.5232480534666997, 0.09394051075844168, 0.5759464955561793, 0.9292961975762141, 0.31856895245132366, 0.6674103799636817, 0.13179786240439217, 0.7163272041185655, 0.0, 0.0, 0.2894060929472011, 0.18319136200711683, 0.5865129348100832, 0.020107546187493552, 0.8289400292173631, 0.004695476192547066, 0.6778165367962301, 0.27000797319216485, 0.7351940221225949, 0.9621885451174382, 0.0, 0.0, 0.24875314351995803, 0.5761573344178369, 0.592041931271839, 0.5722519057908734, 0.2230816326406183, 0.952749011516985, 0.44712537861762736, 0.8464086724711278, 0.6994792753175043, 0.29743695085513366, 0.0, 0.0, 0.8137978197024772, 0.39650574084698464, 0.8811031971111616, 0.5812728726358587, 0.8817353618548528, 0.6925315900777659, 0.7252542798196405, 0.5013243819267023, 0.9560836347232239, 0.6439901992296374, 0.0, 0.0, 0.4238550485581797, 0.6063932141279244, 0.019193198309333526, 0.30157481667454933, 0.660173537492685, 0.29007760721044407, 0.6180154289988415, 0.42876870094576613, 0.13547406422245023, 0.29828232595603077, 0.0, 0.0, 0.5699649107012649, 0.5908727612481732, 0.5743252488495788, 0.6532008198571336, 0.6521032700016889, 0.43141843543397396, 0.896546595851063, 0.36756187004789653, 0.4358649252656268, 0.8919233550156721, 0.0, 0.0, 0.8061939890460857, 0.7038885835403663, 0.10022688731230112, 0.9194826137446735, 0.7142412995491114, 0.9988470065678665, 0.14944830465799375, 0.8681260573682142, 0.16249293467637482, 0.6155595642838442, 0.0, 0.0, 0.12381998284944151, 0.8480082293222344, 0.8073189587250107, 0.5691007386145933, 0.40718329722599966, 0.06916699545513805, 0.6974287731445636, 0.45354268267806885, 0.7220555994703479, 0.8663823259286292, 0.0, 0.0, 0.9755215050028858, 0.855803342392611, 0.011714084185001972, 0.3599780644783639, 0.729990562424058, 0.17162967726144052, 0.5210366062041293, 0.05433798833925363, 0.19999652489640007, 0.01852179446061397, 0.0, 0.0, 0.7936977033574206, 0.22392468806038013, 0.3453516806969027, 0.9280812934655909, 0.7044144019235328, 0.03183892953130785, 0.16469415649791275, 0.6214784014997635, 0.5772285886041676, 0.23789282137450862, 0.0, 0.0, 0.9342139979247938, 0.613965955965896, 0.5356328030249583, 0.589909976354571, 0.7301220295167696, 0.31194499547960186, 0.3982210622160919, 0.20984374897512215, 0.18619300588033616, 0.9443723899839336, 0.0, 0.0, 0.7395507950492876, 0.4904588086175671, 0.22741462797332324, 0.25435648177039294, 0.05802916032387562, 0.4344166255581208, 0.3117958819941026, 0.6963434888154595, 0.3777518392924809, 0.1796036775596348, 0.0, 0.0, 0.02467872839133123, 0.06724963146324858, 0.6793927734985673, 0.4536968445560453, 0.5365792111087222, 0.8966712930403421, 0.9903389473967044, 0.21689698439847394, 0.6630782031001008, 0.26332237673715064, 0.0, 0.0, 0.02065099946572868, 0.7583786538361414, 0.32001715082246784, 0.38346389417189797, 0.5883171135536057, 0.8310484552361904, 0.6289818435911487, 0.8726506554473953, 0.27354203481563577, 0.7980468339125637, 0.0, 0.0, 0.1856359443059522, 0.9527916569719446, 0.6874882763878153, 0.21550767711355845, 0.9473705904889242, 0.7308558067701578, 0.25394164259502583, 0.21331197736748198, 0.5182007139306632, 0.025662718054531575, 0.0, 0.0, 0.2074700754411094, 0.42468546875150626, 0.37416998033422555, 0.4635754243648107, 0.2776287062947319, 0.5867843464581688, 0.8638556059232314, 0.11753185596203308, 0.5173791071541142, 0.1320681063451533, 0.0, 0.0, 0.7168596811925937, 0.39605970280729375, 0.565421311858509, 0.18327983621407862, 0.14484775934337724, 0.48805628064895457, 0.3556127378499556, 0.940431945252813, 0.7653252538069653, 0.7486636198505473, 0.0, 0.0, 0.9037197397459334, 0.08342243544201855, 0.5521924699224066, 0.5844760689557689, 0.961936378547229, 0.29214752679254885, 0.24082877991544682, 0.10029394226549782, 0.016429629591474204, 0.9295293167921905, 0.0, 0.0, 0.66991654659091, 0.7851529120231378, 0.2817301057539491, 0.5864101661863267, 0.06395526612098112, 0.4856275959346229, 0.9774951397444468, 0.8765052453165908, 0.33815895183684563, 0.9615701545414985, 0.0, 0.0, 0.2317016264712045, 0.9493188224156814, 0.9413777047064986, 0.7992025873523917, 0.6304479368667911, 0.874287966624947, 0.2930202845077967, 0.8489435553129182, 0.6178766919175238, 0.01323685775889949, 0.0, 0.0, 0.34723351793221957, 0.14814086094816503, 0.9818293898182532, 0.47837030703998806, 0.4973913654986627, 0.6394725163987236, 0.3685846061296175, 0.13690027168559893, 0.8221177331942455, 0.18984791190275796, 0.0, 0.0, 0.511318982546456, 0.22431702897473926, 0.09784448449403405, 0.8621915174216833, 0.9729194890231303, 0.9608346580630002, 0.906555499221179, 0.7740473326986388, 0.3331451520286419, 0.08110138998799676, 0.0, 0.0, 0.40724117141380733, 0.23223414217094274, 0.13248763475798297, 0.05342718178682526, 0.7255943642105788, 0.011427458625031028, 0.7705807485027762, 0.14694664540037505, 0.07952208258675575, 0.08960303423860538, 0.0, 0.0, 0.6720478073539145, 0.24536720985284477, 0.42053946668009845, 0.5573687913239169, 0.8605511738287938, 0.7270442627113283, 0.27032790523871464, 0.1314827992911276, 0.05537432042119794, 0.3015986344809425, 0.0, 0.0, 0.26211814923967824, 0.45614056680047965, 0.6832813355476804, 0.6956254456388572, 0.28351884658216664, 0.3799269559001205, 0.18115096173690304, 0.7885455123065187, 0.0568480764332403, 0.6969972417249873, 0.0, 0.0, 0.7786953959411034, 0.7774075618487531, 0.25942256434535493, 0.37381313793256143, 0.587599635196389, 0.272821902424467, 0.3708527992178887, 0.19705428018563964, 0.4598558837560074, 0.044612301254114084, 0.0, 0.0, 0.799795884570618, 0.07695644698663273, 0.518835148831526, 0.3068100995451961, 0.5775429488313755, 0.9594333408334251, 0.6455702444560039, 0.03536243575549092, 0.43040243950806123, 0.5100168523182502, 0.0, 0.0, 0.536177494703452, 0.6813925106038379, 0.2775960977317661, 0.1288605654663202, 0.39267567654709434, 0.9564057227959488, 0.18713089175084474, 0.903983954928237, 0.5438059500773263, 0.4569114216457658, 0.0, 0.0, 0.8820414102298896, 0.45860396176858587, 0.7241676366115433, 0.399025321703102, 0.9040443929009577, 0.6900250201912274, 0.6996220542505167, 0.3277204015571189, 0.7567786427368892, 0.6360610554471413, 0.0, 0.0, 0.24002027337970955, 0.16053882248525642, 0.7963914745173317, 0.9591666030352225, 0.45813882726004285, 0.5909841653236849, 0.8577226441935546, 0.45722345335385706, 0.9518744768327362, 0.5757511620448724, 0.0, 0.0, 0.820767120701315, 0.9088437184127384, 0.8155238187685688, 0.15941446344895593, 0.6288984390617004, 0.3984342586196771, 0.0627129520233457, 0.42403225188984195, 0.2586840668894077, 0.8490383084285108, 0.0, 0.0, 0.03330462654669619, 0.9589827218634736, 0.3553688484719296, 0.3567068904025429, 0.01632850268370789, 0.18523232523618394, 0.4012595008036087, 0.9292914173027139, 0.09961493022127133, 0.9453015334790795, 0.0, 0.0, 0.8694885305466322, 0.4541623969075518, 0.32670088176826007, 0.23274412927905685, 0.6144647064768743, 0.03307459147550562, 0.015606064446828216, 0.42879572249823783, 0.0680740739747202, 0.2519409882460929, 0.0, 0.0, 0.22116091534608384, 0.2531911937228519, 0.13105523121525775, 0.01203622289765427, 0.11548429713874808, 0.6184802595127479, 0.9742562128180503, 0.9903450015608939, 0.4090540953730616, 0.16295442604660537, 0.0, 0.0, 0.6387617573665293, 0.49030534654873714, 0.9894097772844315, 0.0653042071517802, 0.7832344383138131, 0.2883984973314939, 0.241418620076574, 0.662504571532676, 0.24606318499096447, 0.6658591175591877, 0.0, 0.0, 0.5173085172022888, 0.4240889884358493, 0.554687808661419, 0.28705151991962974, 0.7065747062729789, 0.414856869333564, 0.36054556048589226, 0.8286569145557378, 0.9249669119531921, 0.046007310887296926, 0.0, 0.0, 0.2326269928297655, 0.34851936949256324, 0.8149664793702474, 0.9854914276432976, 0.9689717046703518, 0.9049483455499269, 0.2965562650640299, 0.9920112434144741, 0.2494200410564512, 0.1059061548822322, 0.0, 0.0, 0.9509526110553941, 0.2334202554680963, 0.6897682650777505, 0.05835635898058866, 0.7307090991274762, 0.8817202123338397, 0.2724368954659625, 0.37905689607742854, 0.3742961833209161, 0.7487882575401331, 0.0, 0.0, 0.23780724253903884, 0.171853099047643, 0.4492916486877381, 0.3044684073773195, 0.8391891222586524, 0.23774182601563876, 0.5023894574892614, 0.9425835996979304, 0.6339976977446607, 0.8672894054624648, 0.0, 0.0, 0.9402096893547673, 0.7507648618863519, 0.6995750602247514, 0.9679655666042271, 0.9944007896476794, 0.45182168266975964, 0.07086977818420837, 0.29279403144051885, 0.15235470568773046, 0.4174863747960118, 0.0, 0.0, 0.13128932847325603, 0.604117804020882, 0.3828080591578541, 0.89538588428821, 0.9677946717985019, 0.5468849016694222, 0.2748235698675966, 0.5922304187618368, 0.8967611582244098, 0.4067333458357483, 0.0, 0.0, 0.5520782766919708, 0.2716527676061459, 0.455444149450027, 0.40171353537959864, 0.24841346508297102, 0.5058663838253084, 0.3103808259798114, 0.37303486388074747, 0.5249704422542643, 0.7505950229289875, 0.0, 0.0, 0.3335074657912753, 0.9241587666207636, 0.8623185468359024, 0.04869029597552854, 0.25364252425682277, 0.4461355126592019, 0.10462788874247408, 0.3484759890334971, 0.7400975256176825, 0.6805144811428259, 0.0, 0.0, 0.6223844285660048, 0.7105284027223456, 0.20492368695970176, 0.3416981148647321, 0.6762424822774629, 0.8792347630313271, 0.5436780538280952, 0.2826996509455366, 0.03023525800598259, 0.7103368289742134, 0.0, 0.0, 0.007884103508440377, 0.3726790698209955, 0.5305372145627818, 0.922111461767193, 0.08949454503290011, 0.4059423219682837, 0.024313199710157773, 0.3426109843415903, 0.6222310588397949, 0.2790679482285984, 0.0, 0.0, 0.2097499496556351, 0.11570323332709365, 0.5771402440203418, 0.695270005904686, 0.6719571405958223, 0.9488610207205074, 0.0027032138935026984, 0.647196653894036, 0.6003922370976396, 0.5887396099702882, 0.0, 0.0, 0.9627703198402424, 0.016871673370039697, 0.6964824307014501, 0.8136786497018634, 0.5098071966215841, 0.33396486959680916, 0.7908401632274049, 0.09724292563242465, 0.44203563772992527, 0.5199523745708382, 0.0, 0.0, 0.6939564109345475, 0.09088573203240946, 0.22775950153786095, 0.41030156269012563, 0.6232946730201306, 0.8869607812174175, 0.6188261682413765, 0.13346147093493443, 0.9805801327872824, 0.8717857347554929, 0.0, 0.0, 0.502720761145324, 0.922347981796633, 0.5413807937571358, 0.9233060678891631, 0.8298973686033432, 0.9682864102942973, 0.9197828107781584, 0.03603381742856948, 0.17477200416093996, 0.38913467710118577, 0.0, 0.0, 0.9521426972954208, 0.3000289194759296, 0.16046764388760104, 0.8863046660865599, 0.4463944154832029, 0.9078755943543261, 0.16023046632014326, 0.6611175115080995, 0.4402637528294918, 0.0764867690302854, 0.0, 0.0, 0.6964631446525006, 0.2473987555391537, 0.039615522579517726, 0.05994429824957326, 0.06107853706678734, 0.9077329574850395, 0.739883917829101, 0.8980623572137351, 0.6725823112965214, 0.5289399290308832, 0.0, 0.0, 0.30444636434737826, 0.9979622513286734, 0.36218905893938935, 0.47064894921390954, 0.37824517492346177, 0.9795269293354586, 0.17465838539500578, 0.32798800090807967, 0.6803486660150015, 0.06320761833863064, 0.0, 0.0, 0.607249374011541, 0.4776465028764161, 0.2839999767621011, 0.238413280924058, 0.5145127432987567, 0.36792758053704133, 0.45651989126265535, 0.3374773817642399, 0.9704936935959776, 0.13343943174560402, 0.0, 0.0, 0.0968039531783742, 0.34339172879091606, 0.5910269008704913, 0.6591764718500283, 0.39725674716804205, 0.9992779939221711, 0.3518929961930426, 0.7214066679599525, 0.6375826945307929, 0.8130538632474607, 0.0, 0.0, 0.97622566345382, 0.8897936564455402, 0.7645619743577086, 0.6982484778182906, 0.3354981696758996, 0.14768557820670736, 0.06263600305980976, 0.24190170420148482, 0.4322814811812986, 0.5219962736299825, 0.0, 0.0, 0.7730835540548716, 0.958740923056593, 0.11732048038481102, 0.10700414019379156, 0.5896947230135507, 0.745398073947293, 0.8481503803469849, 0.9358320802167885, 0.983426242260642, 0.3998016922245259, 0.0, 0.0, 0.3803351835275731, 0.14780867669727238, 0.6849344386835594, 0.6567619584408371, 0.8620625958512073, 0.09725799478764063, 0.4977769078253418, 0.5810819296720631, 0.2415570400399184, 0.16902540612916128, 0.0, 0.0, 0.8595808364196215, 0.058534922235558784, 0.4706209039180729, 0.11583400130088528, 0.45705876133136736, 0.9799623263423093, 0.4237063534554728, 0.8571249175045673, 0.11731556418319389, 0.27125207676186414, 0.0, 0.0, 0.4037927406673345, 0.39981214000933074, 0.6713834786701531, 0.34471812737550767, 0.7137668684100164, 0.6391868992253925, 0.3991611452547731, 0.43176012765431926, 0.6145276998103207, 0.07004219014464463, 0.0, 0.0, 0.8224067383556903, 0.6534211611136369, 0.7263424644178352, 0.5369230010823904, 0.11047711099174473, 0.4050356132969499, 0.40537358284855607, 0.3210429900432169, 0.02995032490474936, 0.7372542425964773, 0.0, 0.0, 0.1097844580625007, 0.6063081330450851, 0.7032174964672158, 0.6347863229336947, 0.959142251977975, 0.10329815508513862, 0.8671671591051991, 0.029190234848913255, 0.534916854927084, 0.4042436179392588, 0.0, 0.0, 0.5241838603937582, 0.3650998770600098, 0.19056691494006806, 0.01912289744868978, 0.5181498137911743, 0.8427768626848423, 0.37321595574479416, 0.22286381801498023, 0.08053200347184408, 0.08531092311870336, 0.0, 0.0, 0.22139644629277222, 0.10001406092155518, 0.26503969836448205, 0.06614946211695472, 0.06560486720992564, 0.8562761796227819, 0.16212026070883323, 0.559682405823448, 0.7734555444490305, 0.4564095653390666, 0.0, 0.0, 0.15336887785934572, 0.19959614212011434, 0.43298420628118073, 0.5282340891785358, 0.3494402920485349, 0.7814796002346613, 0.7510216488563984, 0.9272118073731179, 0.02895254902696054, 0.8956912912102034, 0.0, 0.0, 0.39256878846215104, 0.8783724953799941, 0.6907847761565296, 0.9873487570739682, 0.7592824517166681, 0.3645446259967866, 0.5010631728347521, 0.37638915519435123, 0.3649118360212381, 0.26090449938105975, 0.0, 0.0, 0.4959702953734696, 0.6817399450693612, 0.2773402713052435, 0.52437981107722, 0.11738029417055718, 0.1598452868541913, 0.04680635471218875, 0.9707314427706328, 0.0038603515102610952, 0.1785799680576563, 0.0, 0.0, 0.6128667531169923, 0.0813695988533053, 0.8818965030968323, 0.7196201578422882, 0.9663899714378934, 0.5076355472407649, 0.3004036831584872, 0.5495005727952714, 0.9308187172979732, 0.5207614372418605, 0.0, 0.0, 0.26720703186231864, 0.8773987891741196, 0.3719187485124613, 0.0013833499989991394, 0.24768502249231594, 0.3182335091770624, 0.8587774682319022, 0.458503167066445, 0.44458728781130075, 0.3361022663998874, 0.0, 0.0, 0.8806781230470796, 0.9450267769403914, 0.9918903291546294, 0.37674126696098675, 0.9661474456271714, 0.7918795696309013, 0.6756891476442668, 0.24488947942009942, 0.2164572609442098, 0.16604782452124567, 0.0, 0.0, 0.9227566102253654, 0.2940766623831661, 0.45309424544887844, 0.4939578339872235, 0.7781715954502542, 0.8442349615530241, 0.1390727011486128, 0.4269043602110737, 0.8428548878354571, 0.8180333057558384, 0.0, 0.0, 0.1024137584524164, 0.156383348867963, 0.3041986915994078, 0.07535906908334034, 0.4246630028405929, 0.10761770514958191, 0.568217593669845, 0.24655693981115612, 0.5964330653496227, 0.11752564290363765, 0.0, 0.0, 0.9758838684185334, 0.9325612038573404, 0.3917969385646658, 0.24217859412608544, 0.2503982128535728, 0.48339353520239203, 0.03999280190071697, 0.639705106075127, 0.4083029083397448, 0.3774065725888873, 0.0, 0.0, 0.8093649714891984, 0.70903546018329, 0.954333815392692, 0.3519362404956907, 0.8975427646494055, 0.7699671862500889, 0.35742465159471304, 0.6216654364532578, 0.2885699576516956, 0.8743999170748423, 0.0, 0.0, 0.11242731721231125, 0.21243436129404103, 0.18303329207992114, 0.40302600240428865, 0.7452329600321291, 0.5269074490521803, 0.48767632353820756, 0.0005459648969956543, 0.4254017253550547, 0.06355377483615843, 0.0, 0.0, 0.20825325212148382, 0.9323939389604944, 0.2153982043432382, 0.8583376386342625, 0.8028933715613342, 0.15914623694224284, 0.6057119572702788, 0.11566187190501331, 0.7278881583695115, 0.6374622773722066, 0.0, 0.0, 0.8119385616910193, 0.47938454938918806, 0.9148630878333829, 0.04934894678843971, 0.29288856502701466, 0.715052597465167, 0.41810921174800086, 0.17295135427115638, 0.10721074542854603, 0.8173391114616214, 0.0, 0.0, 0.47314297846564424, 0.8822836719191074, 0.733289134316726, 0.4097262056307436, 0.37351101415568366, 0.5156383466512517, 0.8890599531897286, 0.7372785797141679, 0.00515296426902323, 0.6941578513691256, 0.0, 0.0, 0.9195074069058207, 0.7104557595044916, 0.1770057815674959, 0.4835181274274587, 0.1403160179234194, 0.3589952783396321, 0.9371170419405177, 0.9233053075587083, 0.2828368521760829, 0.33963104416619916, 0.0, 0.0, 0.6002128681312939, 0.96319729526038, 0.14780133406539042, 0.2569166436866691, 0.8735568272907714, 0.4918922317083445, 0.8989610922270317, 0.18551789752317627, 0.5326685874713607, 0.32626963264937237, 0.0, 0.0, 0.31654255989247604, 0.44687696394619913, 0.43307744910126844, 0.3573468796779544, 0.9149707703156186, 0.7317441854328928, 0.7275469913315297, 0.2899134495919554, 0.5777094243168404, 0.779179433301834, 0.0, 0.0, 0.7955903685432131, 0.34453046075431226, 0.7708727565686478, 0.735893896807733, 0.14150648562190027, 0.8659454685664772, 0.4413214701804108, 0.48641044888866547, 0.4483691788979973, 0.5678460014775075, 0.0, 0.0, 0.6211692473670547, 0.4981795657629434, 0.8667885432590956, 0.6277347561952844, 0.40142794930551995, 0.41669175690871096, 0.8108386151289514, 0.3481919427465201, 0.21145479578241355, 0.059383188005789234, 0.0, 0.0, 0.8760268479205742, 0.9185464511903499, 0.12012018216347597, 0.33447374149611486, 0.17537206951524387, 0.11589846882587973, 0.8998667430000302, 0.05687725914535546, 0.9804856634690068, 0.09645086069738418, 0.0, 0.0, 0.8634706491935857, 0.5665061069891627, 0.36791748781787337, 0.3423423766251579, 0.7573641432377087, 0.3145732950042872, 0.6573189166171418, 0.5173260835160801, 0.4849656451580705, 0.9011621706491616, 0.0, 0.0};

std::vector<float> bias {1, 1, 1, 1, 1, 1, 1, 1, 1, 1};
std::vector<float> bias_rand {0.5546450586202596, 0.8268616030486949, 0.7255735341014894, 0.03855724605899835, 0.7731100525054192, 0.21687025009104066, 0.9031496468515715, 0.042924190608832014, 0.33307203447431877, 0.09973294723475401};

GemmReluGraphTest<GemmReluScalarMKNK, 1, 84, 10> fpscalar_mknk(
  "fpscalar_mknk", weights_mknk, bias, "gemm_fpin.txt", "gemm_fpout_GemmReluScalarMKNK.txt");
GemmReluGraphTest<GemmReluScalarMKNK, 1, 84, 10> fpscalar_mknk_rand(
  "fpscalar_mknk_rand", weights_mknk_rand, bias_rand, "gemm_fpin_rand.txt", "gemm_fpout_GemmReluScalarMKNK_rand.txt");

GemmReluGraphTest<GemmReluScalarMKKN, 1, 84, 10> fpscalar_mkkn(
  "fpscalar_mkkn", weights_mkkn, bias, "gemm_fpin.txt", "gemm_fpout_GemmReluScalarMKKN.txt");
GemmReluGraphTest<GemmReluScalarMKKN, 1, 84, 10> fpscalar_mkkn_rand(
  "fpscalar_mkkn_rand", weights_mkkn_rand, bias_rand, "gemm_fpin_rand.txt", "gemm_fpout_GemmReluScalarMKKN_rand.txt");

GemmReluGraphTest<GemmReluMKKN, 1, 84, 10> fpvector_mkkn(
  "fpvector_mkkn", weights_mkkn, bias, "gemm_fpin.txt", "gemm_fpout_GemmReluMKKN.txt");
GemmReluGraphTest<GemmReluMKKN, 1, 84, 10> fpvector_mkkn_rand(
  "fpvector_mkkn_rand", weights_mkkn_rand, bias_rand, "gemm_fpin_rand.txt", "gemm_fpout_GemmReluMKKN_rand.txt");

GemmReluGraphTest<GemmReluMKKN, 1, 84, 10> lenet(
  "lenet", fc3_weight, fc3_bias, fc3_in, fc3_out);


#ifdef __X86SIM__
int main(int argc, char ** argv) {
  adfCheck(fpscalar_mknk.init(), "init fpscalar_mknk");
  adfCheck(fpscalar_mknk.run(ITER_CNT), "run fpscalar_mknk");
	adfCheck(fpscalar_mknk.end(), "end fpscalar_mknk");

  adfCheck(fpscalar_mknk_rand.init(), "init fpscalar_mknk_rand");
  adfCheck(fpscalar_mknk_rand.run(ITER_CNT), "run fpscalar_mknk_rand");
	adfCheck(fpscalar_mknk_rand.end(), "end fpscalar_mknk_rand");

  adfCheck(fpscalar_mkkn.init(), "init fpscalar_mkkn");
  adfCheck(fpscalar_mkkn.run(ITER_CNT), "run fpscalar_mkkn");
	adfCheck(fpscalar_mkkn.end(), "end fpscalar_mkkn");

  adfCheck(fpscalar_mkkn_rand.init(), "init fpscalar_mkkn_rand");
  adfCheck(fpscalar_mkkn_rand.run(ITER_CNT), "run fpscalar_mkkn_rand");
	adfCheck(fpscalar_mkkn_rand.end(), "end fpscalar_mkkn_rand");

  adfCheck(fpvector_mkkn.init(), "init fpvector_mkkn");
  adfCheck(fpvector_mkkn.run(ITER_CNT), "run fpvector_mkkn");
	adfCheck(fpvector_mkkn.end(), "end fpvector_mkkn");

  adfCheck(fpvector_mkkn_rand.init(), "init fpvector_mkkn_rand");
  adfCheck(fpvector_mkkn_rand.run(ITER_CNT), "run fpvector_mkkn_rand");
	adfCheck(fpvector_mkkn_rand.end(), "end fpvector_mkkn_rand");
  return 0;
}
#endif


#ifdef __AIESIM__
int main(int argc, char ** argv) {
  adfCheck(fpscalar_mknk.init(), "init fpscalar_mknk");
  get_graph_throughput_by_port(fpscalar_mknk, "plout[0]", fpscalar_mknk.plout[0], 1*10, sizeof(float_t), ITER_CNT);
	adfCheck(fpscalar_mknk.end(), "end fpscalar_mknk");

  adfCheck(fpscalar_mknk_rand.init(), "init fpscalar_mknk_rand");
  get_graph_throughput_by_port(fpscalar_mknk_rand, "plout[0]", fpscalar_mknk_rand.plout[0], 1*10, sizeof(float_t), ITER_CNT);
	adfCheck(fpscalar_mknk_rand.end(), "end fpscalar_mknk_rand");

  adfCheck(fpscalar_mkkn.init(), "init fpscalar_mkkn");
  get_graph_throughput_by_port(fpscalar_mkkn, "plout[0]", fpscalar_mkkn.plout[0], 1*10, sizeof(float_t), ITER_CNT);
	adfCheck(fpscalar_mkkn.end(), "end fpscalar_mkkn");

  adfCheck(fpscalar_mkkn_rand.init(), "init fpscalar_mkkn_rand");
  get_graph_throughput_by_port(fpscalar_mkkn_rand, "plout[0]", fpscalar_mkkn_rand.plout[0], 1*10, sizeof(float_t), ITER_CNT);
	adfCheck(fpscalar_mkkn_rand.end(), "end fpscalar_mkkn_rand");

  adfCheck(fpvector_mkkn.init(), "init fpvector_mkkn");
  get_graph_throughput_by_port(fpvector_mkkn, "plout[0]", fpvector_mkkn.plout[0], 1*10, sizeof(float_t), ITER_CNT);
	adfCheck(fpvector_mkkn.end(), "end fpvector_mkkn");

  adfCheck(fpvector_mkkn_rand.init(), "init fpvector_mkkn_rand");
  get_graph_throughput_by_port(fpvector_mkkn_rand, "plout[0]", fpvector_mkkn_rand.plout[0], 1*10, sizeof(float_t), ITER_CNT);
	adfCheck(fpvector_mkkn_rand.end(), "end fpvector_mkkn_rand");
  return 0;
}
#endif
